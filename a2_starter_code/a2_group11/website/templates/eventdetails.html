<!-- Extension inherits from base.html file -->
{% extends "base.html" %}
{% set e = event or {} %}

<!-- Title -->
{% block title %}FoodieVent Event Details Page{% endblock %}

{% block header %}
<!-- Header begins-->
<!--Event details page Jumbotron-->
<div class="p-5 detailjumbotronimage rounded-3">
  <div class="container-fluid py-5">
    <h1 class="display-5 fw-bold">Event Details</h1>
    <p class="col-md-8 fs-4">Are you interested in this event? Please read below for more specific event
      details and how to book tickets.</p>
  </div>
</div>
<!-- Header ends -->
{% endblock %}


{% block content %}
{% block content %}
<main class="py-4">
  <div class="container">

    <!-- breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-3">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('home') if 'home' in globals() else '#' }}">Home</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('events') if 'events' in globals() else '#' }}">Events</a></li>
        <li class="breadcrumb-item active" aria-current="page">Event details</li>
      </ol>
    </nav>

    <!-- title -->
    <header class="mb-3">
      <h1 class="display-6 mb-1" id="page-header">{{ e.title or 'Mid-Autumn Festival 2025' }}</h1>
      <p class="text-muted mb-0">Located at {{ e.venue or 'Chinatown Mall, Fortitude Valley QLD' }}</p>
    </header>

    <!-- main card -->
    <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
      <div class="row g-0">
        <!-- image -->
        <div class="col-12 col-lg-5">
          <img
            src="{{ url_for('static', filename='img/MooncakeFestival.jpg') }}"
            class="w-100 h-100 object-fit-cover"
            alt="{{ (e.title or 'Event') ~ ' photo' }}"
            loading="lazy">
        </div>

        <!-- details -->
        <div class="col-12 col-lg-7">
          <div class="card-body p-4">

            <!-- quick facts -->
            {% set status = (e.status or 'Open')|lower %}
            <div class="d-flex flex-wrap gap-2 mb-3">
              <span class="badge text-bg-{{ 'success' if status=='open' else 'secondary' if status=='sold out' else 'danger' if status=='cancelled' else 'primary' }}">
                Status: {{ e.status or 'Open' }}
              </span>
              <span class="badge text-bg-info">Category: {{ e.category or 'Cultural' }}</span>
              <span class="badge text-bg-{{ 'success' if (e.tickets or 200) > 0 else 'secondary' }}">
                Tickets: {{ e.tickets or 200 }}
              </span>
            </div>

            <!-- description -->
            <p class="mb-4">
              {{ e.description or
              'The Mid-Autumn Festival is a Chinese cultural food festival celebrating mooncakes and community.' }}
            </p>

            <!-- date & time -->
            <ul class="list-group list-group-flush mb-4">
              <li class="list-group-item px-0">
                <strong>Date:</strong>
                {{ e.date or '06/10/2025' }}
              </li>
              <li class="list-group-item px-0">
                <strong>Starts:</strong> {{ e.start or '4:00 PM AEST' }}
                &nbsp;&nbsp; <strong>Ends:</strong> {{ e.end or '11:00 PM AEST' }}
              </li>
              <li class="list-group-item px-0">
                <strong>Vendors:</strong> {{ e.vendors or 'Sunnybank Jade Moon Bakery, Lotus & Yolk, Riverlight Mooncake House' }}
              </li>
              <li class="list-group-item px-0">
                <strong>Free sampling:</strong> {{ e.free_sampling if e is defined and e.free_sampling is not none else 'No' }}
                &nbsp;&nbsp; <strong>Takeaway:</strong> {{ e.takeaway if e is defined and e.takeaway is not none else 'Yes' }}
              </li>
            </ul>

            <!-- actions -->
            <div class="d-flex flex-wrap gap-2">
              <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#bookModal">
                Book Now
              </button>
              <a class="btn btn-primary" href="{{ url_for('update_event', id=e.id) if e and 'update_event' in globals() else '#' }}">
                Update Event
              </a>
              <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#cancelModal">
                Cancel Event
              </button>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- map -->
    <div class="card border-0 shadow-sm rounded-4 mt-4">
      <div class="card-body">
        <h2 class="h5 mb-3">Venue map</h2>
        <div class="ratio ratio-16x9">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3540.34047232225!2d153.03119297545862!3d-27.458657776326035!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b9159f26b169b0b%3A0xe862f341887a48f9!2sChinatown%20Mall!5e0!3m2!1sen!2sau!4v1756686852213!5m2!1sen!2sau"
            loading="lazy" referrerpolicy="no-referrer-when-downgrade" style="border:0" allowfullscreen
            title="Map to venue"></iframe>
        </div>
      </div>
    </div>

    <!-- comments -->
    <section class="mt-4">
      <h2 class="h5 mb-3">Comments</h2>
      <div class="list-group">
        <a href="#inputComment" class="list-group-item list-group-item-action">
          <div class="d-flex w-100 justify-content-between">
            <h6 class="mb-1">Comment #0003</h6><small class="text-muted">3 days ago</small>
          </div>
          <p class="mb-1">I had the time of my life at the last Mid-Autumn Festival! …</p>
          <small class="text-muted">Posted by JohnBrown776</small>
        </a>
        <!-- repeat your existing two items -->
      </div>

      <form class="mt-3">
        <label for="inputComment" class="form-label">Post a comment</label>
        <textarea class="form-control" id="inputComment" name="description" rows="4"
                  placeholder="Share your thoughts…"></textarea>
        <div class="mt-2">
          <button type="reset" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#postCommentModal">
            Post Comment
          </button>
        </div>
      </form>
    </section>

  </div>
</main>
{% endblock %}